{% include base_path %}

{% if post.header.teaser %}
  {% capture teaser %}{{ post.header.teaser }}{% endcapture %}
{% else %}
  {% assign teaser = site.teaser %}
{% endif %}

{% if post.id %}
  {% assign title = post.title | markdownify | remove: "<p>" | remove: "</p>" %}
{% else %}
  {% assign title = post.title %}
{% endif %}

<style>
  /* --- Layout card --- */
  .prj-entry {
    display: flex;
    align-items: center;
    gap: 20px;
    text-align: left;
    margin: 2em 0;
  }

  /* --- Media box condiviso (img/iframe stessa dimensione) --- */
  .media-box {
    position: relative;
    width: 300px;             /* desktop */
    height: 200px;            /* desktop */
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    overflow: hidden;
    margin: 0 auto;
    flex: 0 0 auto;           /* non allargare */
  }

  /* Contenuti del media riempiono il box */
  .media-box > img,
  .media-box > iframe {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    display: block;
    border: 0;
  }

  /* Per le immagini, mantieni crop stile cover */
  .media-box > img {
    object-fit: cover;
  }

  /* --- Testi --- */
  .profile-title {
    font-size: 1.5rem;
    font-weight: bold;
    margin: 1rem 0 .5rem 0;
  }

  .profile-desc {
    font-size: 1rem;
    color: #555;
    margin-bottom: 1rem;
  }

  .social-icons-custom { margin-top: 1rem; }
  .social-icons-custom a {
    font-size: 1.5rem;
    margin: 0 10px;
    color: #555;
    text-decoration: none;
  }
  .social-icons-custom a:hover { color: #000; }

  /* --- Mobile: media sopra, testi sotto; media responsive 3:2 --- */
  @media (max-width: 768px) {
    .prj-entry {
      flex-direction: column;     /* testi sotto al media */
      align-items: center;
      text-align: center;
    }
    .media-box {
      width: 100%;
      max-width: 300px;           /* non superare il desktop size */
      height: auto;
      aspect-ratio: 3 / 2;        /* mantiene 300:200 */
    }
    .media-box > iframe { height: 100%; }
  }
</style>

<div class="prj-entry">
  {% if post.embed %}
    <div class="media-box">
      {{ post.embed
          | replace: '<iframe', '<iframe class="profile-iframe" allowfullscreen'
      }}
    </div>
  {% else %}
    <div class="media-box">
      <img src="{{ post.image | relative_url }}" alt="Project Image">
    </div>
  {% endif %}

  <div class="prj-body">
    <p class="profile-title">{{ post.title }}</p>
    <p class="profile-desc"><i>{{ post.desc }}</i></p>
    <div class="social-icons-custom">
      {% if post.github %}
        <a href="{{ post.github }}" target="_blank"><i class="fab fa-github"></i></a>
      {% endif %}
      {% if post.paperurl %}
        <a href="{{ post.paperurl }}" target="_blank"><i class="fas fa-file-pdf"></i></a>
      {% endif %}
      {% if post.youtube %}
        <a href="{{ post.youtube }}" target="_blank" style="color: red;"><i class="fab fa-youtube"></i></a>
      {% endif %}
      {% if post.webpage %}
        <a href="{{ post.webpage }}" target="_blank"><i class="fas fa-globe"></i> try now!</a>
      {% endif %}
    </div>
  </div>
</div>